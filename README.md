# udp_test
＜概要＞
・クライアントは、送信データを入力ファイルから作る
・10回定周期で送信する
・送信が終わったら処理を終了する。

・サーバは、受信したデータを出力ファイルに書き出す
・受信した時刻と受信データをファイルに書き出す
・10回ファイルへの書き出しが終わったら処理を終了する

・テスト送信データ
　パケットの中身(Max1500バイト)を記載する

・テスト受信データ
　パケットのデータを書き出す

・テスト受信データ２（時間）
　パケットの受信時刻を書き出す　

・結果の確認
　・テスト送信データのファイルを開き、期待される送信データを、テスト期待ファイルに書き出す
　・テスト受信データとテスト期待値ファイルのデータが一致していることを確認する

## 1.クライアント側

## 2.サーバ側

## 3.入力データのファイル

## 4.出力データのファイル

## 5.結果の確認

## 実行方法
### 実行ファイル生成
gcc udp_server.c -o udp_server
gcc udp_client.c -o udp_client
### ターミナル１
./udp_server test_rx_1.txt test_rx_1_time.txt
### ターミナル2
./udp_client test_tx_1.txt
### ターミナル３
./check_result test01_expected.txt test_rx_1.txt test_rx_1_time.txt test_result_YYYYMMDD.txt

## メモ
(1)とりあえずループバックアドレスで試しておく。

　ブロードキャスト送信の場合、上手く自装置には折り返せなかったので、
　仮想マシンを使用する必要がありそう。
　QEMUならブリッジインターフェースとtapを追加すればできそう。
　もちろん実機を使用するなら問題ないが、通信相手を用意する必要があるので面倒。

(2)注意点
　test_rx_1.txtでは、データを受信した後に改行を入れているので、ファイルの最後に改行が発生する。
　比較チェックする時、期待値ファイルも改行を入れるとかして同一ファイルになるようにした方が良い。
　改行を読み飛ばす処理を入れるのもありだが、
　・パケットの区切りの改行と間違えないようにする
　・読み飛ばすために、EOFまでfgetcを繰り返すと最後の1文字が欠けているケースで不一致になっていても
　　プログラムで気づけないことがあるので実装時は注意が必要。

(3)結局どこまで自動で確認するかを詰める必要がある
　・受信したアプリヘッダ（期待値を作るのが難しそう（シーケンス番号とかサム値とか））
　・受信したアプリデータ
　・送受信間隔？